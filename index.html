<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Attendance System</title>
<style>
body {
  font-family: Arial, sans-serif;
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
  background: #f0f4f8;
  margin: 0;
}

.card {
  background: #fff;
  padding: 2rem;
  border-radius: 15px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.1);
  width: 100%;
  max-width: 400px;
  text-align: center;
}

/* Logo styles */
#companyLogo {
  width: 120px;
  height: 120px;
  border-radius: 50%;
  object-fit: contain;
  display: block;
  margin: 0 auto 1.5rem auto;
  border: 2px solid rgba(29,78,216,0.2);
  box-shadow: inset 0 0 20px rgba(0,0,0,0.05);
}

h1 {
  margin-bottom: 1.5rem;
}

input, button {
  width: 100%;
  padding: 0.75rem;
  margin: 0.5rem 0 0.75rem 0;
  border-radius: 10px;
  border: 1px solid #ccc;
  font-size: 1rem;
  box-sizing: border-box;
}

button {
  cursor: pointer;
  background-color: #2563eb;
  color: #fff;
  border: none;
}

button#checkOut {
  background-color: #f1f5f9;
  color: #2563eb;
  border: 1px solid rgba(37,99,235,0.3);
}

#status {
  margin-top: 1rem;
  font-size: 0.95rem;
}
</style>
</head>
<body>
<div class="card">
<img id="companyLogo" src="https://osaad2177-creator.github.io/Attendance-Zoom/assets/logo.svg" alt="Company Logo">
<h1>Attendance System</h1>
<input type="text" id="employeeName" placeholder="Enter full name" required>
<button id="checkIn">✅ Check In</button>
<button id="checkOut">❌ Check Out</button>
<div id="status"></div>
</div>

<script>
const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwB-MuJHOQNcFnTqd3mo5C0SMXkqbn7o_UB7VGe7_5ICfGuPRrt7LDaqO4Gj8Y7EOgyqg/exec';

async function sendAttendance(type) {
  const name = document.getElementById('employeeName').value.trim();
  const status = document.getElementById('status');
  if (!name) { status.innerText = 'Please enter your name'; return; }

  if (!navigator.geolocation) { status.innerText = 'Geolocation not supported'; return; }

  status.innerText = 'Fetching location...';

  navigator.geolocation.getCurrentPosition(async (pos) => {
    const lat = pos.coords.latitude;
    const lng = pos.coords.longitude;

    try {
      const url = new URL(APPS_SCRIPT_URL);
      url.searchParams.set('employee_name', name);
      url.searchParams.set('attendance_type', type);
      url.searchParams.set('latitude', lat);
      url.searchParams.set('longitude', lng);

      const res = await fetch(url, { mode: 'cors' });
      const text = await res.text();
      if (res.ok) {
        status.innerHTML = text + `<br><a href="https://www.google.com/maps?q=${lat},${lng}" target="_blank">View location</a>`;
      } else {
        status.innerText = text || 'Error recording attendance';
      }
    } catch (err) {
      status.innerText = 'Network error. Try again.';
    }
  }, (err) => {
    status.innerText = 'Location permission denied or unavailable';
  }, { enableHighAccuracy: true, timeout: 15000 });
}

document.getElementById('checkIn').addEventListener('click', () => sendAttendance('Check In'));
document.getElementById('checkOut').addEventListener('click', () => sendAttendance('Check Out'));
</script>
</body>
</html>
